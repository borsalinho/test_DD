<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Тестовое задание №1. Верста страницы</title>
    <link rel="stylesheet" href="./style.css">
</head>
<body>
    <header>
        <section>
            <h1>
                TypeScript: общие впечатления
            </h1>
            <nav>
                <ol>
                    <h2>
                        Оглавление
                    </h2>
                    <li>
                        <a href="#anchor1">
                            Введение
                        </a>
                    </li>
                    <li>
                        <a href="#anchor2">
                            Небольшая выжимка в качестве описания этого языка
                        </a>
                    </li>
                    <li>
                        <a href="#anchor3">
                            Какие возможности открывает язык
                        </a>
                    </li>
                    <li>
                        <a href="#anchor4">
                            Основные ссылки
                        </a>
                    </li>
                    <li>
                        <a href="#anchor5">
                            Почему стоит попробовать TypeScript?
                        </a>
                    </li>
                    <li>
                        <a href="#anchor6">
                            С другой стороны, есть ряд минусов
                        </a>
                    </li>
                    <li>
                        <a href="#anchor7">
                            Начинаем работать
                        </a>
                    </li>
                    <li>
                        <a href="#anchor8">
                            Небольшой итог
                        </a>
                    </li>
                    <li>
                        <a href="#anchor9">
                            Картинка по заданию
                        </a>
                    </li>
                </ol>
            </nav>
        </section>
    </header>
    <main>
        <section>
            <h2 id="anchor1">
                Введение
            </h2>
            <p>
                Думаю, многие из вас знают, что сейчас существует обилие различных языков (или инструментов), которые позволяют писать код компилируемый в JavaScript. Это CoffeeScript, Dart, GorillaScript и другие (довольно большой список можно найти <a href="https://github.com/jashkenas/coffeescript/wiki/List-of-languages-that-compile-to-JS">здесь</a> ). Недавно я решил познакомиться с одним из представителей этого списка — языком программирования под названием <a href="https://www.typescriptlang.org/">TypeScript</a> .
                <br>
                <br>
                Я расскажу о личном опыте — почему решил попробовать именно его, как начать работать с ним, и какие выводы сделал, поработав с ним несколько дней.
                <br>
                <br>
                Если вам это интересно — пожалуйста, заходите под кат.
            </p>
        </section>

        <section>
            <h2 id="anchor2">
                Небольшая выжимка в качестве описания этого языка
            </h2>
            <ul>
                <li>
                    Язык со строгой типизацией
                </li>
                <li>
                    Код написанный на TypeScript компилируется в JavaScript
                </li>
                <li>
                    Язык обратно совместим с JavaScript — если вы скормите компилятору чистый JavaScript, компилятор выплюнет вам ваш же JS, и не скажет что это ошибка. Можно писать смешанный код (например, модули/методы используя синтаксис TypeScript, а реализацию методов без типизации на чистом JS) — это тоже будет валидно.
                </li>
                <li>
                    Язык разработан компанией Microsoft.
                </li>
            </ul>
        </section>

        <section>
            <h2 id="anchor3">
                Какие возможности открывает язык
            </h2>
            <ul>
                <li>
                    Система для работы с модулями/классами — можно создать интерфейсы, модули, классы;
                </li>
                <li>
                    Можно наследовать интерфейсы (в том числе множественное наследование), классы;
                </li>
                <li>
                    Можно описывать собственные типы данных;
                </li>
                <li>
                    Можно создавать универсальные-интерфейсы (generic interfaces);
                </li>
                <li>
                    Можно описать тип переменной (или свойств объекта), или описать каким интерфейсом должен обладать объект на который ссылается переменная;
                </li>
                <li>
                    Можно описать сигнатуру метода.
                </li>
            </ul>
            <i>Конечно, это далеко не все — это лишь основные моменты, которые я выделил.</i>
        </section>

        <section>
            <h2 id="anchor4">
                Основные ссылки
            </h2>
            <ul>
                <li>
                    Страница чтобы «поиграться» с языком — <a href="https://www.typescriptlang.org/play?#code/PTAEHUFMBsGMHsC2lQBd5oBYoCoE8AHSAZVgCcBLA1UABWgEM8BzM+AVwDsATAGiwoBnUENANQAd0gAjQRVSQAUCEmYKsTKGYUAbpGF4OY0BoadYKdJMoL+gzAzIoz3UNEiPOofEVKVqAHSKymAAmkYI7NCuqGqcANag8ABmIjQUXrFOKBJMggBcISGgoAC0oACCbvCwDKgU8JkY7p7ehCTkVDQS2E6gnPCxGcwmZqDSTgzxxWWVoASMFmgYkAAeRJTInN3ymj4d-jSCeNsMq-wuoPaOltigAKoASgAywhK7SbGQZIIz5VWCFzSeCrZagNYbChbHaxUDcCjJZLfSDbExIAgUdxkUBIursJzCFJtXydajBBCcQQ0MwAUVWDEQC0gADVHBQGNJ3KAALygABEAAkYNAMOB4GRonzFBTBPB3AERcwABS0+mM9ysygc9wASmCKhwzQ8ZC8iHFzmB7BoXzcZmY7AYzEg-Fg0HUiQ58D0Ii8fLpDKZgj5SWxfPADlQAHJhAA5SASPlBFQAeS+ZHegmdWkgR1QjgUrmkeFATjNOmGWH0KAQiGhwkuNok4uiIgMHGxCyYrA4PCCJSAA">TypeScript Playground</a> 
                </li>
                <li>
                    Спецификация языка — <a href="https://www.typescriptlang.org/Content/TypeScript%20Language%20Specification.pdf">TypeScript Language Specification</a>
                </li>
                <li>
                    Быстрая вводная — <a href="https://www.typescriptlang.org/docs/">TypeScript Handbook</a>
                </li>
                
            </ul>
        </section>

        <section>
            <h2 id="anchor5">
                Почему стоит попробовать TypeScript?
            </h2>
            <p>
                Размышляя о том, почему имеет смысл попробовать поработать на TypeScript, я выделил несколько основных пунктов:
            </p>
            <ul>
                <li>
                    Возможность жестко описать каждый элемент приложения — это, вероятно, исключает возможность неверной реализации или некорректного вызова методов; Заставляет разработчиков продумать логику (например, в методах) до самой реализации; Не дает возможность изменить один кусок приложения, сломав другой;
                </li>
                <li>
                    Возможность описать область видимости свойств класса — еще один барьер, который ограничивает разработчика от совершения ошибок;
                </li>
                <li>
                    Из-за жесткой архитектуры, возможно, необходимо писать меньше тестов — все параметры методов жестко описаны, и если код скомпилировался, тогда, вероятно, каждый вызов является валидным, и не требует дополнительной проверки;
                </li>
                <li>
                    Можно настроить проект таким образом, что любой некомпилируемый код (фактически, код с синтаксической ошибкой) нельзя будет закоммитить. Случаи в которых разработчик позволяет себе закоммитить сломанный код в обход проверок перед коммитом не рассматриваем;
                </li>
                <li>
                    Многие конструкции в TypeScript имеют жесткий формат, поэтому многие из ошибок форматирования кода (в соответствии каким-то принятым в коллективе нормам) исключены. Я думаю что это плюс, потому что процесс ревью кода часто выявляет ошибки форматирования, на которые тратится ценное время. Если это время можно потратить на другие более полезные активности — это уже плюс.
                </li>
                
            </ul>
        </section>

        <section>
            <h2 id="anchor6">
                С другой стороны, есть ряд минусов:
            </h2>
            <ul>
                <li>
                    Чтобы использовать какой-то внешний инструмент (читай «библиотеку» или «фреймворк»), тогда сигнатуру каждого из методов каждого модуля этого инструмента необходимо описать, чтобы компилятор не выбрасывал ошибки (он просто не будет знать про ваш инструмент). Если это популярный инструмент, тогда, вероятнее всего, описание интерфейсов можно найти в <a href="https://github.com/DefinitelyTyped/DefinitelyTyped">этом репозитории</a> . Если нет — придется описывать самому;
                </li>
                <li>
                    Вероятно, самый большой минус (возможно, временный) — порог вхождения и количество специалистов на рынке. Сейчас почти нет специалистов которые знают этот язык. Это плохо, потому что любой солидный проект со временем переходит на этап поддержки, и в случае потери специалистов, найти им замену будет сложнее. Возможно, я ошибаюсь, но я пришел к этому выводу опираясь на статистику Github (<a href="https://github.com/search?l=TypeScript&p=1&q=language%3ATypeScript&ref=advsearch&type=Repositories&utf8=%E2%9C%93">ссылка</a> ) — создано лишь ~6k репозиториев с TypeScript кодом против ~1.4kk на JavaScript;
                </li>
                <li>
                    На разработку тратится больше времени, в сравнении с JavaScript. Это вызвано тем, что помимо реализации класса необходимо описать все задействованные интерфейсы, сигнатуры методов.
                </li>
               
                
            </ul>
        </section>

        <section>
            <h2 id="anchor7">
                Начинаем работать
            </h2>
            <p>
                Перехожу к небольшим заметкам, которые я оставлял в уме по мере работы с TypeScript.
            </p>
            <h3>
                Сборка
            </h3>
            <p>
                Прежде всего, было необходимо написать сборщик тестового проекта. Есть несколько NPM пакетов для gulp которые позволяют компилировать TypeScript код в JavaScript. Без знания что выбрать я начал пробовать все пакеты в том порядке, в каком мне их выдал Google. Оказалось, что не все пакеты используют последнюю версию компилятора (последняя версия была 1.5.0), и из-за этого код который компилировался на сайте TypeScript не компилировался плагином для gulp. Методом проб и ошибок я остановился на пакете gulp-tsc, который поддерживает все версии компилятора и работает «на ура».
            </p>
            <h3>
                Компиляция
            </h3>
            <p>
                Каждый интерфейс, сигнатура каждого экспортированного метода: все это должно быть известно компилятору, иначе он откажется компилировать код. Я работал с AMD модулями (об этом чуть позже), и при импорте одних модулей в другие возникала проблема — компилятор совершенно ничего не знал об существовании других модулей.
                <br>
                <br>
                Для этих целей существуют .d.ts файлы — файлы, в которых нужно определить что конкретно экспортирует тот или иной модуль, какие глобальные переменные и функции определены.
                <br>
                <br>
                На первый взгляд — все просто. На деле здесь обнаружился подводный камень (смотрим код ниже).
            </p>

            <u>
                Создадим файл foo.ts в котором определим модуль foo:
            </u>
            <pre>
                <code>
                    <span>export</span> = {
                        <span>bar</span>:<span><span>()</span> =&gt;</span><span>'baz'</span>
                    }
                </code>
            </pre>

            <u>
                Создадим файл bar.ts в котором определим модуль bar, который импортирует модуль foo:
            </u>
            <pre>
                <code>
                    <span >import</span> foo = <span>require</span>(<span>'foo'</span>);
                    <span>// Ошибка: "Cannot find external module 'foo'."</span>

                    <span>export</span> = {
                        <span>foo</span>: foo
                    }
                </code>
            </pre>

            <p>
                Мы получили ошибку «Не удается найти внешний модуль foo.». Почему так происходит? Так происходит потому что этот модуль мы нигде не определили и компилятор про него не знает.
            </p>

            <u>
                Создадим файл foo.d.ts, в котором расскажем компилятору, что есть такой модуль foo, и он экспортирует один метод bar:
            </u>

            <pre>
                <code>
                    <span>declare</span><span>module</span> foo {
                        <span>export</span><span> function</span> bar(): <span >string</span>
                    }
                </code>
            </pre>
            
            <p>
                Мы добавили определение модуля и теперь все похоже на правду, все должно заработать, не правда ли? Неправда, потому что ровным счетом ничего от этого не изменилось — компилятор по-прежнему не может найти модуль foo. Вопрос — почему?
                <br>
                <br>
                <b>Решение оказалось неожиданным — название модуля было определено не в кавычках.</b>
            </p>

            <u>Работающий код файла foo.d.ts:</u>

            <pre>
                <code><span>declare</span> <span>module</span> <span>'foo'</span> {
                    <span>export</span> <span>function</span> bar(): <span>string</span>
                }
                </code>
            </pre>

            <i>Едем дальше...</i>

            <h3>AMD</h3>
            <p>
                Конечно, если TypeScript дает возможность создавать AMD-модули и можно красиво импортировать зависимости, почему бы этим не воспользоваться хотя бы для теста?
                <br>
                <br>
                Я попробовал — в TypeScript по-определению нельзя генерировать модули с именами. TypeScript дает возможность генерировать модули без имен, не более. Мне показалось, что это было бы странно, и оказалось, что это можно обойти.
            </p>
            <u>Пример модуля, который будет скомпилирован в модуль с именем:</u>
            <pre>
                <code>
                    <span>export</span> = {
                        <span>bar</span>: <span><span>()</span> =&gt;</span> <span>'baz'</span>
                    }
                </code>
            </pre>

            <h3>
                Что еще интересного?
            </h3>
            <p>
                Большая часть времени, проведенного за кодированием на TypeScript, не доставила проблем, но довольно часто возникают тонкие моменты, решение которых довольно трудно найти. Одна из таких проблем, которую я не смог решить на текущий момент — как описать объект, свойства которого будут динамически определяться (названия свойств неизвестны), но каждый из них должен содержать объект, который имеет строго определенный интерфейс?
            </p>
            <u>Пример неработающего кода:</u>
            <pre>
                <code><span>interface</span> <span>IBar</span> {
                    baz: <span>string</span>
                }
                
                <span>var</span> foo: {
                    [<span>property: string</span>]: IBar
                }
                
                foo = {};
                
                foo.foobar = {
                    baz: <span>'Hi there!'</span>
                }
                </code>
            </pre>
            <br>
            <br>
            <u>Пример работающего кода:</u>
            <pre>
                <code><span>interface</span> <span>IBar</span> {
                    baz: <span>string</span>
                }
                
                <span>var</span> foo: {
                    [<span>property: string</span>]: IBar
                }
                
                foo = {
                    foobar: {
                        baz: <span>'Hi there!'</span>
                    }	
                };
                </code>
            </pre>
            <p>Это, конечно, не все проблемы, которые возникли, но каждая из них носит именно такой характер, как в примере выше.</p>

            <h3>
                Небольшой список других проблем:
            </h3>
            <ul>
                <li>
                    Нельзя красиво определить сигнатуру конструктора;
                </li>
                <li>
                    Чтобы сказать TypeScript что мы ожидаем в методе получить конструктор в качестве параметра, а не экземпляр класса, нужно написать function foo (bar: typeof Baz) {… new Baz(...)… } а не просто function foo (bar: Baz) {… new Baz(...)… }.
                </li>
            </ul>
        </section>

        <section>
            <h2 id="anchor8">
                Небольшой итог
            </h2>
            <p>
                Для себя я отметил TypeScript как отличный инструмент, который позволит исключить некоторые риски (в основном, исключение возможности ошибки, и все проблемы из этого вытекающие), позволяет жестко описать взаимодействие между элементами приложения, предлагает базовые инструменты для работы с модулями/классами и компилируется не в бороду из кода, а в достаточно читаемый код.
            </p>
        </section>
        <section>
            <h2 id="anchor9">Ну и картинка, тк по заданию - требовалось</h2>
            <figure>
                <img class="img-BOROMIRR" src="./img/img-for-dd.jpeg"  alt="Мем с Боромиром">
                <br>
                <br>
                <figcaption><i>Я согласен с Боромиром</i></figcaption>
            </figure>
        </section>
        <!-- фиксированная изчезающая кнопка возврата вверх -->
        <button class="back-to-top">
            Вернуться вверх
        </button>
    </main>
    <footer>
        <p>
            Проект сделан для <a href="https://digdes.ru/it-university/courses/front-end-development">DD</a> в виде тестового задания, а материал переписал <a href="https://habr.com/ru/post/258957/">отсюда</a>, т.к. нельзя просто так взять и написать обзор на веб-технологию. 
        </p>
    </footer>
    <script src="./script.js"></script>
</body>
</html>